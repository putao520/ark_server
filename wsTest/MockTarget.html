<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
</head>
<body>
  <input id="message-text" type="text">
  <button id="send">发送</button>
  <button id="close">关闭</button>
  <div id="message-list"></div>
</body>
<script type="text/javascript">
  var ws = new WebSocket('ws://localhost:8088');
  ws.onopen = function(evt) { // 连接建立触发
    console.log('建立连接，状态:' + ws.readyState);
  };

  ws.onmessage = function(evt) { // 服务端返回数据触发
    var data = JSON.parse(evt.data)
    console.log("状态：" + ws.readyState + "；服务端返回数据:", data);
    var list = document.getElementById("message-list");
    list.insertAdjacentHTML("beforeEnd", `<div>${data.message}</div>`);
  };

  ws.onerror = function(evt) { // 通信发生错误触发
    console.log('发生错误，状态:' + ws.readyState);
  };  

  ws.onclose = function(evt) { // 连接关闭触发
    console.log("连接关闭，状态：", ws.readyState);
  }; 

  document.getElementById("send").onclick = function () {
    var val = document.getElementById("message-text").value
    var data = {
      message: val
    }
    ws.send(JSON.stringify(data)); // 推送数据到服务器, 数据类型必须为字符串
  }

  document.getElementById("close").onclick = function () {
    ws.close(); // 关闭连接
  }
</script>
</html>